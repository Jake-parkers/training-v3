= Centrality Algorithms
:slug: 08-iga-40-centrality-algorithms
:doctype: book
:toc: left
:toclevels: 4
:imagesdir: ../images
:module-next-title: Similarity Algorithms

== Centrality algorithms

In network analysis, centrality measures identify the most important or influential nodes within a graph.
The centrality concepts were first introduced in social network analysis to identify key players within a social network, but have since found applications in a variety of industries and fields.

Product supported:
* PageRank

* Betweenness Centrality

Labs implementations:
* Degree Centrality

* ArticleRank

* Closeness Centrality

* Harmonic Centrality

* Eigenvector Centrality

== PageRank

PageRank is Google’s popular web page ranking algorithm.
It works by counting the number and quality of links to a node to estimate its significance.
The underlying assumption is that a node is only as important as the nodes that link to it.
An example of this type of influence might be having the ear of a general that considers you very credible will likely make you more powerful than being popular with your fellow foot soldiers.
PageRank measures importance in comparison to other nodes using an iterative process to update ranks.
It starts by assigning values to nodes as 1/n (n is the total number of nodes linked to) and value to relationships as that nodes value/number of its outgoing links.

image::pagerank-step-1.png[PageRank step 1,width=500, align=center]

It then starts to update values for nodes as the sum of the prior in-link values. The relationship values are updated the same way they were initially assigned.

image::pagerank-step-2.png[PageRank step 2,width=500, align=center]

PageRank then continues to update values until an iterate value is reached.

image::pagerank-step-3.png[PageRank step 3,width=500, align=center]

There are many domain-specific variations for differing analyses, e.g. Personalized PageRank for personalized recommendations.
Personalized PageRank is a variation of PageRank, which is biased towards a set of pre-defined source nodes.

Here is why you use PageRank:

* Recommendations
* Fraud Detection 
* Feature engineering for machine learning

Here are some example:

* Twitter uses Personalized PageRank to present users with recommendations of other accounts that they may wish to follow. The algorithm is run over a graph that contains shared interests and common connections.

* PageRank has been used to rank public spaces or streets, predicting traffic flow and human movement in these areas. The algorithm is run over a graph of road intersections, where the PageRank score reflects the tendency of people to park, or end their journey, on each street.

* PageRank is also used as part of an anomaly and fraud detection system in the healthcare and insurance industries. It helps reveal doctors or providers that are behaving in an unusual manner and then feeds the score into a machine learning algorithm. 

* Find the most influential features for extraction in machine learning and rank text for entity relevance in natural language processing. 

== Guided Exercise: Getting Started with PageRank algorithm

[.notes]
--
ifdef::backend-revealjs[]
Show the students the basics of using Neuler and have them do the same on their systems:

. Select the Centralities group of algorithms.
. Select the PageRank algorithm.
. Select the *Person* label and *HELPS* relationship type.
. Leave the default settings.
. Run the algorithm.
. View the table results.
. View the chart results.
. View the visualization.
. Make a new configuration and select the weight property *weight*.
. Run the algorithm.
. View the table results.
. View the generated code.
. Show them how to copy the query from NEuler to Neo4j Browser.

Explain results.
In PageRank algorithm, every link is considered as a vote of importance from a node to a node.
Alongside the number of links, the algorithm also considers how important are the nodes that link to a specific node.

Here is the video:  https://youtu.be/oHo-lQ79zf0

endif::[]
--

ifdef::backend-html5,backend-pdf[]
Follow along with this video to become familiar with PageRank in Neo4j Neuler.
endif::[]

ifdef::backend-pdf[]
https://youtu.be/oHo-lQ79zf0
endif::[]

ifdef::backend-revealjs[]
[.center]
https://youtu.be/oHo-lQ79zf0
endif::[]

ifdef::backend-html5[]
[.center]
video::oHo-lQ79zf0[youtube,width=560,height=315]
endif::[]

=== Exercise: PageRank

In NEuler:
* Perform the PageRank analysis on different seasons of GOT.

In Neo4j Browser:
* :play intro-graph-algos-exercises  (PageRank)


== Betweenness Centrality

Sometimes the most critical cog in the system is not the one with the most overt power or the highest status.
Sometimes it’s the middlemen who connect groups or brokers with the most control over resources or information flow.
Betweenness Centrality is a way of detecting the amount of influence a node has over the flow of information in a network.
It is typically used to find nodes that serve as a bridge from one part of a graph to another.

image::betweenness-centrality.png[Betweenness centrality,width=500, align=center]

The Betweenness Centrality algorithm first calculates the shortest path between every pair of nodes in a connected graph.
Each node receives a score based on the number of these shortest paths that pass through the node.
The more shortest paths that a node lies on, the higher its score.

Betweenness centrality doesn’t scale well on large graphs as the algorithm has to calculate the shortest path between all pairs of nodes in a network.
Because of this, approximation algorithms of betweenness centrality were developed to allow for a faster calculation.
The RA-Brandes algorithm is the best-known algorithm for calculating an approximate score for betweenness centrality.
Rather than calculating the shortest path between every pair of nodes, the RA-Brandes algorithm considers only a subset of nodes.
Brandes defines several strategies for selecting the subset of nodes.
Our implementation is based on the random degree selection strategy, which selects nodes with a probability proportional to their degree. 
The idea behind this strategy is that such nodes are likely to lie on many shortest paths in the graph and thus have a higher contribution to the betweenness centrality score.

Here is why you use Betweenness Centrality:

* Identify bridges.

* Uncover control points.

* Find bottlenecks and vulnerabilities.

Here are some example:

* Betweenness Centrality is used to identify influencers in various organizations. Powerful individuals are not necessarily in management positions, but can be found in “brokerage positions” using Betweeness Centrality. Removal of such influencers seriously destabilize the organization. This might be a welcome disruption by law enforcement if the organization is criminal, or may be a disaster if a business loses key staff it never knew about.

* Betweeness Centrality uncovers key transfer points in networks such electrical grids. Counterintuitively, removal of specific bridges can actually improve overall robustness by “islanding” disturbances.

* Betweenness Centrality is also used to help microbloggers spread their reach on Twitter, with a recommendation engine for targeting influencers. 

== Guided Exercise: Getting Started with Betweenness centrality algorithm

[.notes]
--
ifdef::backend-revealjs[]
Show the students the basics of using Neuler and have them do the same on their systems:

. Select the Centralities group of algorithms.
. Select the Betweenness centrality algorithm.
. Select the *Person* label and *HELPS* relationship type.
. Leave the default settings.
. Run the algorithm.
. View the table results.
. View the visualization.
. View the generated code.
. Show them how to copy the query from NEuler to Neo4j Browser.

Explain results.
Betweenness centrality identifies nodes that are often on located on a shortest path between other nodes in network, hence also why bridges.

Here is the video:  https://youtu.be/oHo-lQ79zf0

endif::[]
--

ifdef::backend-html5,backend-pdf[]
Follow along with this video to become familiar with Betweenness Centrality in Neo4j Neuler.
endif::[]

ifdef::backend-pdf[]
https://youtu.be/oHo-lQ79zf0
endif::[]

ifdef::backend-revealjs[]
[.center]
https://youtu.be/oHo-lQ79zf0
endif::[]

ifdef::backend-html5[]
[.center]
video::oHo-lQ79zf0[youtube,width=560,height=315]
endif::[]

=== Exercise: Betweenness centrality

In NEuler:
* View the betweenness centrality scores for other GOT seasons and examine the paths in Neo4j Browser for these nodes.
* View the approximate betweenness centrality scores for GOT seasons and see how various sampling sizes affect the results.

In Neo4j Browser:
* :play intro-graph-algos-exercises  (Betweenness Centrality)


== Summary
